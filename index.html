<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Italian-English Flashcards</title>
    <link rel="manifest" href="data:application/json;base64,ewogICJuYW1lIjogIkl0YWxpYW4tRW5nbGlzaCBGbGFzaGNhcmRzIiwKICAic2hvcnRfbmFtZSI6ICJGbGFzaGNhcmRzIiwKICAic3RhcnRfdXJsIjogIi4vaW5kZXguaHRtbCIsCiAgImRpc3BsYXkiOiAic3RhbmRhbG9uZSIsCiAgImJhY2tncm91bmRfY29sb3IiOiAiI2YzZjRmNiIsCiAgInRoZW1lX2NvbG9yIjogIiMzYjgyZjYiLAogICJpY29ucyI6IFsKICAgIHsKICAgICAgInNyYyI6ICJkYXRhOmltYWdlL3N2Zyt4bWw7YmFzZTY0LFBITjJaeUI0Yld4dWN6MGlhSFIwY0RvdkwzZDNkeTUzTXk1dmNtY3ZNakF3TUM5emRtY2lJSFpwWlhkQ2IzZzlJakFnTUNBMk1DQTJNRDRLUEdjK0NqeHdZWFJvSUdacGJHdzlJaU16TXpNaUlHUTlJazAxTVRJZ05qUkRNalkwTGpZZ05qUWdOalFnTWpZMExqWWdOalFnTlRFeWN6SXdNQzQySURRME9DQTBORGdnTkRRNElEUTBPQzB5TURBdU5pQTBORGd0TkRRNFV6YzFPQzQySURZMElEVXhNaUEyTkhwdE1DQTRNakJqTFRJd05TNDBJREF0TXpjeUxURTJOaTQyTFRNM01pMHpOekp6TVRZMkxqWXRNemN5SURNM01pMHpOeklnTXpjeUlERTJOaTQySURNM01pQXpOekl0TVRZMkxqWWdNemN5TFRNM01pQXpOeko2SWk4K0NqeHdZWFJvSUdacGJHdzlJaU16TXpNaUlHUTlJazB5TnpnZ01USXdZeTAwTnpRdU5TQXdMVEk0TWkweE5UY3VPQzB5T0RJdE1qZ3ljekg0TkNBeU9ESXRNQ0F5T0RJZ05EYzBMalVnTUM0eElERTJPQzQwTFRFMU55NDRJREk0TWkweU9ESjZiVEFnT0RJd0xURTJPQ0EzTWpKekxURTFOeTQ0SURJNEppQXlPREl0TkRjeElERTFOeTQ0SURJNEpnb2lMejRLUEM5blBnbzhMM04yWno0PSIsCiAgICAgICJzaXplcyI6ICIxNDR4MTQ0IiwKICAgICAgInR5cGUiOiAiaW1hZ2UvcG5nIgogICAgfQogIF0KfQ==">
    <meta name="theme-color" content="#3b82f6">
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css">
    <style>

        html, body {
            height: 100%;
            margin: 0;
            padding: 0;
        }

        body {
            display: flex;
            flex-direction: column;
        }

        .container {
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: center; /* This centers content vertically */
        }

        #flashcard-container {
            display: flex;
            align-items: center;
            justify-content: center;
            height: 60vh; /* Adjust this value as needed */
        }

        .flashcard {
            width: 100%;
            max-width: 400px;
            aspect-ratio: 16 / 9;
            display: flex;
            align-items: center;
            justify-content: center;
        }

    
        .flashcard {
            perspective: 1000px;
        }
        .flashcard-inner {
            transition: transform 0.6s;
            transform-style: preserve-3d;
        }
        .flashcard.flipped .flashcard-inner {
            transform: rotateY(180deg);
        }
        .flashcard-front, .flashcard-back {
            backface-visibility: hidden;
            position: absolute;
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .flashcard-back {
            transform: rotateY(180deg);
        }
    </style>
</head>
<body class="bg-gray-100 min-h-screen flex flex-col">
    <div class="container mx-auto px-4 py-8 flex-grow flex flex-col">
        <h1 class="text-3xl font-bold text-center mb-4">Italian-English Flashcards</h1>
        <div class="mb-4 flex justify-center">
            <select id="deck-select" class="bg-white border border-gray-300 rounded-md px-4 py-2 mr-2">
                <option value="all">All Cards</option>
                <option value="practice">Practice Deck</option>
            </select>
        </div>
        <div class="flex-grow flex items-center justify-center">
            <div id="flashcard-container" class="w-full max-w-md">
                <!-- Flashcard will be inserted here -->
            </div>
        </div>
        <div class="flex justify-between mt-4">
            <button id="prev-btn" class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded">
                Previous
            </button>
            <button id="next-btn" class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded">
                Next
            </button>
        </div>
    </div>

    <script>
        const flashcardsData = [{"text":"cambio","translations":["(I) shift","in return","derailleur gears","gears","(car) transmission","(I) replace","changed","(I) alter","I change","in exchange","change","(I) exchange","break","relief","exchange rate","turn"],"audioURL":"https://d1vq87e9lcf771.cloudfront.net/anita/37436cc6f45d1495388deab1aba97c08","isNew":false},{"text":"violenza","translations":["act of violence","violence"],"audioURL":"https://d1vq87e9lcf771.cloudfront.net/anita/8324c94620854c69431d1a850015310e","isNew":false},{"text":"elenco","translations":["(I) list","(I) count","(I) enumerate","lists"],"audioURL":"https://d1vq87e9lcf771.cloudfront.net/anita/effafdcfe1373f5e5105af23a16b4917","isNew":false},{"text":"intenzione","translations":["intention","aim","intent","purpose"],"audioURL":"https://d1vq87e9lcf771.cloudfront.net/anita/23ddd9f2744b98679d504a340233c410","isNew":false},{"text":"arrivo","translations":["I come in","(I) arrive","coming","finish","arrival","finished","carry","I'm arriving"],"audioURL":"https://d1vq87e9lcf771.cloudfront.net/anita/5a3e28ebfaafe3963fb5a451c2bf3040","isNew":false},{"text":"partenza","translations":["leaving","departure","start","going"],"audioURL":"https://d1vq87e9lcf771.cloudfront.net/anita/40e7791917402bee1fb7615749816bc3","isNew":false},{"text":"proprietÃ ","translations":["property","characteristic","correctness","estate","ownership","possessions","propriety"],"audioURL":"https://d1vq87e9lcf771.cloudfront.net/anita/38d82c4b7df44881230512cca294e39b","isNew":false},{"text":"ritorno","translations":["(I) return","return","(I) give back","(I) get back","returns"],"audioURL":"https://d1vq87e9lcf771.cloudfront.net/anita/145c43471b3677ff91ce6a84e9688935","isNew":false},{"text":"segno","translations":["(I) mark out","(I) write [something] down","symbols","produce","sign","as a sign of","(I) mark","mark","as a mark of","enter","signs"],"audioURL":"https://d1vq87e9lcf771.cloudfront.net/anita/02597ce39196924946602aac803e89dc","isNew":false}];

        let currentCardIndex = 0;
        let currentTranslationIndex = 0;
        const flashcardContainer = document.getElementById('flashcard-container');
        const prevBtn = document.getElementById('prev-btn');
        const nextBtn = document.getElementById('next-btn');
        const deckSelect = document.getElementById('deck-select');

        // Add practice property to each card
        flashcardsData.forEach(card => {
            card.practice = false;
        });

        function createFlashcard(italianWord, englishTranslation, isPractice) {
            const flashcard = document.createElement('div');
            flashcard.className = 'flashcard w-full h-64 cursor-pointer relative';
            flashcard.innerHTML = `
                <div class="flashcard-inner w-full h-full">
                    <div class="flashcard-front absolute w-full h-full flex items-center justify-center bg-white rounded-lg shadow-md p-4">
                        <p class="text-2xl font-semibold text-center">${englishTranslation}</p>
                    </div>
                    <div class="flashcard-back absolute w-full h-full flex items-center justify-center bg-blue-500 text-white rounded-lg shadow-md p-4">
                        <p class="text-2xl font-semibold text-center">${italianWord}</p>
                    </div>
                </div>
                <button class="star-btn absolute top-2 right-2 text-2xl ${isPractice ? 'text-yellow-400' : 'text-gray-300'}">
                    <i class="fas fa-star"></i>
                </button>
                <button class="delete-btn absolute bottom-2 right-2 text-xl text-red-500">
                    <i class="fas fa-trash"></i>
                </button>
            `;
            flashcard.addEventListener('click', (e) => {
                if (!e.target.closest('.star-btn') && !e.target.closest('.delete-btn')) {
                    flashcard.classList.toggle('flipped');
                }
            });

            const starBtn = flashcard.querySelector('.star-btn');
            starBtn.addEventListener('click', () => {
                const card = flashcardsData[currentCardIndex];
                card.practice = !card.practice;
                starBtn.classList.toggle('text-yellow-400');
                starBtn.classList.toggle('text-gray-300');
            });

            const deleteBtn = flashcard.querySelector('.delete-btn');
            deleteBtn.addEventListener('click', () => {
                if (confirm('Are you sure you want to delete this card?')) {
                    flashcardsData.splice(currentCardIndex, 1);
                    if (currentCardIndex >= flashcardsData.length) {
                        currentCardIndex = flashcardsData.length - 1;
                    }
                    if (flashcardsData.length === 0) {
                        flashcardContainer.innerHTML = '<p class="text-xl text-center">No cards left</p>';
                    } else {
                        showCard(currentCardIndex, 0);
                    }
                }
            });

            return flashcard;
        }

        function showCard(index, translationIndex) {
            if (flashcardsData.length === 0) {
                flashcardContainer.innerHTML = '<p class="text-xl text-center">No cards left</p>';
                return;
            }
            const item = flashcardsData[index];
            const translation = item.translations[translationIndex];
            flashcardContainer.innerHTML = '';
            const flashcard = createFlashcard(item.text, translation, item.practice);
            flashcardContainer.appendChild(flashcard);
        }

        function nextCard() {
            if (flashcardsData.length === 0) return;
            do {
                currentTranslationIndex++;
                if (currentTranslationIndex >= flashcardsData[currentCardIndex].translations.length) {
                    currentTranslationIndex = 0;
                    currentCardIndex = (currentCardIndex + 1) % flashcardsData.length;
                }
            } while (deckSelect.value === 'practice' && !flashcardsData[currentCardIndex].practice);
            showCard(currentCardIndex, currentTranslationIndex);
        }

        function prevCard() {
            if (flashcardsData.length === 0) return;
            do {
                currentTranslationIndex--;
                if (currentTranslationIndex < 0) {
                    currentCardIndex = (currentCardIndex - 1 + flashcardsData.length) % flashcardsData.length;
                    currentTranslationIndex = flashcardsData[currentCardIndex].translations.length - 1;
                }
            } while (deckSelect.value === 'practice' && !flashcardsData[currentCardIndex].practice);
            showCard(currentCardIndex, currentTranslationIndex);
        }

        nextBtn.addEventListener('click', nextCard);
        prevBtn.addEventListener('click', prevCard);
        deckSelect.addEventListener('change', () => {
            currentCardIndex = 0;
            currentTranslationIndex = 0;
            if (deckSelect.value === 'practice') {
                while (!flashcardsData[currentCardIndex].practice) {
                    currentCardIndex = (currentCardIndex + 1) % flashcardsData.length;
                }
            }
            showCard(currentCardIndex, currentTranslationIndex);
        });

        let touchStartX = 0;
        let touchEndX = 0;

        flashcardContainer.addEventListener('touchstart', e => {
            touchStartX = e.changedTouches[0].screenX;
        });

        flashcardContainer.addEventListener('touchend', e => {
            touchEndX = e.changedTouches[0].screenX;
            handleSwipe();
        });

        function handleSwipe() {
            if (touchEndX < touchStartX) nextCard();
            if (touchEndX > touchStartX) prevCard();
        }

        // Initialize the first card
        showCard(currentCardIndex, currentTranslationIndex);

        // Service Worker Registration
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', function() {
                navigator.serviceWorker.register('sw.js').then(function(registration) {
                    console.log('ServiceWorker registration successful with scope: ', registration.scope);
                }, function(err) {
                    console.log('ServiceWorker registration failed: ', err);
                });
            });
        }
    </script>
</body>
</html>
